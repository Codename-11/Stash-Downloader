name: Stash Downloader
description: Download images and videos from URLs with automatic metadata extraction and organization
version: 0.1.0
url: https://github.com/Codename-11/Stash-Downloader
settings:
  defaultDownloadPath:
    displayName: Default Download Path
    description: Default directory for downloaded content (relative to Stash library)
    type: STRING
  concurrentDownloads:
    displayName: Concurrent Downloads
    description: Maximum number of simultaneous downloads
    type: NUMBER
  autoCreatePerformers:
    displayName: Auto-Create Performers
    description: Automatically create new performers if they don't exist in Stash
    type: BOOLEAN
  autoCreateTags:
    displayName: Auto-Create Tags
    description: Automatically create new tags if they don't exist in Stash
    type: BOOLEAN
  autoCreateStudios:
    displayName: Auto-Create Studios
    description: Automatically create new studios if they don't exist in Stash
    type: BOOLEAN
  downloadQuality:
    displayName: Download Quality
    description: "Preferred quality for video downloads (best, 1080p, 720p, 480p)"
    type: STRING
  filenameTemplate:
    displayName: Filename Template
    description: "Template for downloaded filenames. Variables: {title}, {date}, {performers}, {studio}"
    type: STRING
  enableNotifications:
    displayName: Enable Notifications
    description: Show browser notifications for download completion
    type: BOOLEAN

# Python backend for server-side downloads (bypasses CORS)
# Same pattern as PythonDepManager (interface: raw + {pluginDir})
exec:
  - python
  - "{pluginDir}/scripts/download.py"

tasks:
  - name: Download Video
    description: Download a video from URL using yt-dlp (server-side)
    defaultArgs:
      mode: download
  - name: Extract Metadata
    description: Extract video metadata without downloading
    defaultArgs:
      mode: extract_metadata
  - name: Read Result
    description: Read a saved task result from temp file
    defaultArgs:
      mode: read_result
  - name: Cleanup Result
    description: Delete a saved task result file
    defaultArgs:
      mode: cleanup_result
  - name: Check yt-dlp
    description: Check if yt-dlp is installed and available
    defaultArgs:
      mode: check_ytdlp

ui:
  javascript:
    - dist/stash-downloader.js
# interface: raw allows Python exec to work as subprocess
# interface: js is for UI plugins but may break Python exec
interface: raw
